{% comment %}
NatureConnect – Featured Collection Section (Compact Version)
{% endcomment %}

<section class="nc-featured" style="padding: 60px 0; background-color: #fafafa;">
  <div style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
    {% if section.settings.heading != blank %}
      <h2 style="text-align:center; margin-bottom: 40px; font-size: 2rem;">{{ section.settings.heading }}</h2>
  </div>
</section>
    {% endif %}

    {% assign coll = collections[section.settings.collection] %}
    {% if coll and coll.products_count > 0 %}
      <div style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 30px;
        justify-items: center;
      ">
        {% for product in coll.products limit: section.settings.product_count %}
          <article style="
            background: white;
            border: 1px solid #eaeaea;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            padding: 15px;
            width: 100%;
            max-width: 260px;
            text-align: center;
            transition: transform 0.2s ease;
          " onmouseover="this.style.transform='scale(1.03)'" onmouseout="this.style.transform='scale(1)'">
            <a href="{{ product.url }}" style="text-decoration:none; color:inherit;">
              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | img_url: '400x400' }}"
                  alt="{{ product.title }}"
                  style="width:100%; border-radius:10px;">
              {% endif %}
              <h3 style="margin:12px 0 6px; font-size:1rem;">{{ product.title }}</h3>
              <p style="color:#333; font-weight:600;">{{ product.price | money }}</p>
            </a>
{% comment %} Variant picker + Add to Cart on the card {% endcomment %}
<div style="margin-top:8px;">
  {% form 'product', product, class: 'nc-card-form' %}
    {% if product.variants.size > 1 %}
      <label for="v-{{ product.id }}" style="display:block;font-size:.9rem;margin-bottom:6px;color:#444;">
        Options
      </label>
      <select id="v-{{ product.id }}" name="id"
              style="width:100%;padding:8px 10px;border:1px solid #ddd;border-radius:6px;margin-bottom:10px;">
        {% for v in product.variants %}
          <option value="{{ v.id }}" {% unless v.available %}disabled{% endunless %}>
            {{ v.title }}{% unless v.available %} — Sold out{% endunless %}
          </option>
        {% endfor %}
      </select>
    {% else %}
      <input type="hidden" name="id" value="{{ product.variants.first.id }}">
    {% endif %}

    <button type="submit"
            style="width:100%;padding:10px 12px;border:none;border-radius:8px;background:#2e7d32;color:#fff;cursor:pointer;">
      Add to Cart
    </button>
  {% endform %}
</div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p style="text-align:center;">No products found. Please select a collection.</p>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Featured Collection",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Products" },
    { "type": "collection", "id": "collection", "label": "Collection" },
    { "type": "range", "id": "product_count", "label": "Number of products", "min": 1, "max": 20, "step": 1, "default": 6 }
  ],
  "presets": [{ "name": "Featured Collection" }]
}
{% endschema %}
